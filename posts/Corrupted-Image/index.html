<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Manual Recovery of Location Data From JPG" /><meta name="author" content="L15t3Nr" /><meta property="og:locale" content="en" /><meta name="description" content="I am L15t3Nr, a seeker of arcane knowledge in the eldritch realms of cyberspace." /><meta property="og:description" content="I am L15t3Nr, a seeker of arcane knowledge in the eldritch realms of cyberspace." /><link rel="canonical" href="https://l15t3nr.github.io/posts/Corrupted-Image/" /><meta property="og:url" content="https://l15t3nr.github.io/posts/Corrupted-Image/" /><meta property="og:site_name" content="L15t3Nr" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-13T17:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Manual Recovery of Location Data From JPG" /><meta name="twitter:site" content="@L15t3Nr" /><meta name="twitter:creator" content="@L15t3Nr" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"L15t3Nr"},"dateModified":"2025-04-28T19:13:01+00:00","datePublished":"2023-10-13T17:00:00+00:00","description":"I am L15t3Nr, a seeker of arcane knowledge in the eldritch realms of cyberspace.","headline":"Manual Recovery of Location Data From JPG","mainEntityOfPage":{"@type":"WebPage","@id":"https://l15t3nr.github.io/posts/Corrupted-Image/"},"url":"https://l15t3nr.github.io/posts/Corrupted-Image/"}</script><title>Manual Recovery of Location Data From JPG | L15t3Nr</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="L15t3Nr"><meta name="application-name" content="L15t3Nr"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/Avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">L15t3Nr</a></div><div class="site-subtitle font-italic">InfoSec Acolyte</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/L15t3Nr" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/L15t3Nr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['l15t3nr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Manual Recovery of Location Data From JPG</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Manual Recovery of Location Data From JPG</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1697216400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 13, 2023 </em> </span> <span> Updated <em class="" data-ts="1745867581" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 28, 2025 </em> </span><div class="d-flex justify-content-between"> <span> By <em> L15t3Nr </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1778 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="//assets/img/Corrupted-Image/img-1.png" alt="img-1" data-proofer-ignore></p><p>This post is a walkthrough of how to manually recover location data from an image using a hex editor (HxD). I will provide two methods for doing this.</p><p>I will be using an intentionally corrupted image that I created. If you’d like to try it yourself, you can open this image in a new tab and download it, then open it in a hex editor. <img data-src="//assets/img/Corrupted-Image/Corrupted-img-2.jpg" alt="Corrupted Image" data-proofer-ignore></p><p>Most of the image data has been overwritten with null values, which is why the image doesn’t display anything when its opened. This is meant to simulate what might happen if the image file were deleted and partially overwritten, but without the complicated overwritten data and just null values instead. There is just enough data remaining from the original image for it to be identified as a valid image and the important EXIF data still remains in the file! All of this data can be viewed using a Hex Editor such as HxD.</p><h1 id="exif-tool-simple-method">EXIF Tool (Simple Method)</h1><p>You might try taking the jpg file and using an online EXIF tool to view the location data.</p><p><img data-src="//assets/img/Corrupted-Image/img-2.png" alt="Exif Tool" data-proofer-ignore></p><p>Unfortunately, this won’t return any of the useful EXIF information. This has to do with the TIFF Header Structure of this corrupted image. TIFF stands for Tag Image File Format and its used to represent <a href="https://en.wikipedia.org/wiki/Raster_graphics">raster graphics</a>(2-D Images as a grid of pixels) and store image information (like location data or created date).</p><p><img data-src="//assets/img/Corrupted-Image/img-3.png" alt="HxD" data-proofer-ignore></p><p>When looking at a JPG in a hex editor, the first few offsets of the file contain some important information for the EXIF tool to identify the image and the metadata it has.</p><p><code class="language-plaintext highlighter-rouge">FF D8</code> is at offset 0 and 1, and identifies the start of a JFIF, JPE, JPEG, or JPG. These offsets are crucial for the EXIF tool. If these offsets were missing, the EXIF tool would not recognize this file as a JPG.</p><p>There is also a trailer <code class="language-plaintext highlighter-rouge">FF D9</code> which identifies the end of the file.</p><p>The next few offsets can optionally contain an EXIF Tool tag name or an SPIFF tag name. This data has been tampered with, <code class="language-plaintext highlighter-rouge">DE AD BE EF</code> spells <code class="language-plaintext highlighter-rouge">DEADBEEF</code> and doesn’t provide any useful information other than that the files data has been tampered with. These offsets aren’t important for the EXIF tool in finding the metadata anyways.</p><p>Offset <code class="language-plaintext highlighter-rouge">12</code> is where the fun begins and leads towards the first solution of this challenge.</p><p>The start of the TIFF Header Structure can begin with either <code class="language-plaintext highlighter-rouge">4D 4D</code> (MM in ascii) or <code class="language-plaintext highlighter-rouge">49 49</code> (II in ascii). Here, there is a <code class="language-plaintext highlighter-rouge">4D</code> for an M, but only just one. If you are clever and realize there should be two M’s, you might change the null value at offset <code class="language-plaintext highlighter-rouge">13</code> to <code class="language-plaintext highlighter-rouge">4D</code>, save the change and reupload the image to an EXIF Tool.</p><p><img data-src="//assets/img/Corrupted-Image/img-4.png" alt="Changed" data-proofer-ignore></p><p><img data-src="//assets/img/Corrupted-Image/img-5.png" alt="Exif" data-proofer-ignore></p><p><img data-src="//assets/img/Corrupted-Image/img-6.png" alt="Exif" data-proofer-ignore></p><p>With this simple change the exiftool has everything it needs to identify all the IFD entries, including the location data.</p><p><img data-src="//assets/img/Corrupted-Image/well-done.gif" alt="Well Done" data-proofer-ignore></p><p>BUT…if you are an intellectually starving nerd like myself, you might push on to understand where this data actually lives in the file. Why? Because why not? You can’t just leave knowledge on the table.</p><h1 id="image-file-directory-idf-searching-for-gps-data">Image File Directory (IDF) Searching for GPS Data</h1><p><strong>Byte Order and IFD Offset</strong></p><p>The TIFF Header Structure is 8 bytes long.</p><p><img data-src="//assets/img/Corrupted-Image/8-byte-tiff.png" alt="//assets/img/Corrupted-Image/8-byte-tiff.png" data-proofer-ignore></p><div class="table-wrapper"><table><thead><tr><th>Bytes<th>Hex Values<th>Meaning<tbody><tr><td>0 to 7<td><code class="language-plaintext highlighter-rouge">4D 4D 00 2A 00 00 00 08</code><td>8-Bytes<tr><td>0 to 1<td><code class="language-plaintext highlighter-rouge">4D 4D</code><td>Byte Order<tr><td>2 to 3<td><code class="language-plaintext highlighter-rouge">00 2A</code><td>TIFF File<tr><td>4 to 7<td><code class="language-plaintext highlighter-rouge">00 00 00 08</code><td>Offset of the first IFD</table></div><p><strong>Image File Directory</strong></p><p>This is where the image data pointers and metadata are stored. This directory could come before or after the actual image data itself.</p><p>In this case, the IFD0 is located at offset 8. This is heavily confusing because we just looked at offsets 12 to 19 to see the 8 byte TIFF Header Structure. What this offset 8 byte value actually means is to start from the beginning of the TIFF File. The TIFF file began at offset 12 with a value of <code class="language-plaintext highlighter-rouge">4D</code>. We need to add 8 bytes starting from offset 12 and look at the next bytes to see the first IFD entry.</p><p>To put it another way, we can add 12 bytes from the very beginning of the file.</p><p><strong>IFD0</strong></p><p><img data-src="//assets/img/Corrupted-Image/IFD0.png" alt="IFD0" data-proofer-ignore></p><div class="table-wrapper"><table><thead><tr><th>Bytes<th>Hex Value<th>Meaning<tbody><tr><td>+ 02<td><code class="language-plaintext highlighter-rouge">00 0D</code><td>13 Directory Entries<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 00 00 03 00 00 00 01 0F C0 00 00</code><td>Entry 0<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 01 00 03 00 00 00 01 0B D0 00 00</code><td>Entry 1<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 0F 00 02 00 00 00 08 00 00 00 AA</code><td>Entry 2<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 10 00 02 00 00 00 09 00 00 00 B2</code><td>Entry 3<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 12 00 03 00 00 00 01 00 01 00 00</code><td>Entry 4<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 1A 00 05 00 00 00 01 00 00 00 BC</code><td>Entry 5<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 1B 00 05 00 00 00 01 00 00 00 C4</code><td>Entry 6<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 28 00 03 00 00 00 01 00 02 00 00</code><td>Entry 7<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 31 00 02 00 00 00 0E 00 00 00 CC</code><td>Entry 8<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">01 32 00 02 00 00 00 14 00 00 00 DA</code><td>Entry 9<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">02 13 00 03 00 00 00 01 00 01 00 00</code><td>Entry 10<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">87 69 00 04 00 00 00 01 00 00 00 EE</code><td>Entry 11<tr><td>+ 12<td><code class="language-plaintext highlighter-rouge">88 25 00 04 00 00 00 01 00 00 03 1E</code><td>Entry 12<tr><td>+ 04<td><code class="language-plaintext highlighter-rouge">00 00 00 00</code><td>Offset to next IDF (None)</table></div><p>The first 2 bytes tell us that there are 13 12-byte entries that follow. Then the next IFD is pointed to at the end.</p><p><strong>12-Byte Field Entry 0 Breakdown</strong></p><p>The first 12 bytes are broken down as follows:</p><div class="table-wrapper"><table><thead><tr><th>Bytes<th>Hex Value<th>Meaning<th>Information<tbody><tr><td>0 to 11<td><code class="language-plaintext highlighter-rouge">01 00 00 03 00 00 00 01 0F C0 00 00</code><td>IFD Entry 0<td>12-Bytes<tr><td>0 to 1<td><code class="language-plaintext highlighter-rouge">01 00</code><td>Field Identifying Tag<td>256 = <a href="https://exiftool.org/TagNames/EXIF.html">Exif.Image.ImageWidth</a><tr><td>2 to 3<td><code class="language-plaintext highlighter-rouge">00 03</code><td>Field Type<td>SHORT (2 byte unsigned integer)<tr><td>4 to 7<td><code class="language-plaintext highlighter-rouge">00 00 00 01</code><td>Count of the Type<td>1 count<tr><td>8 to 11<td><code class="language-plaintext highlighter-rouge">0F C0 00 00</code><td>The Value Offset<td>0FC0 = 4032</table></div><p>Bytes 8 to 11 don’t actually point to an IFD value offset. Rather, the value of the image width is recorded here instead since it fits in 4 bytes or less. The value is the first 4 bytes starting from the left. <code class="language-plaintext highlighter-rouge">0F C0</code> means the width is 4032 and this is confirmed by looking back at the EXIF tool results:</p><p><img data-src="//assets/img/Corrupted-Image/img-5.png" alt="Exif" data-proofer-ignore></p><p>The 12 byte field entries contain the metadata we want to view. In this first directory entry we looked at the Exif.Image.ImageWidth data. Using an Exif tags table as a reference, we can look for the directory entry that has GPS Info.</p><p><strong>GPS Info Tag</strong></p><p>The GPS info tag has the hex value of <code class="language-plaintext highlighter-rouge">8825</code> and can be searched for within the 13 12-byte entries.</p><p><img data-src="//assets/img/Corrupted-Image/GPS-Info-Tag.png" alt="GPS-info-tag" data-proofer-ignore></p><p>Looking back at the table above, the 13th directory entry contains an Exif Tag for GPS info.</p><p><strong>12-byte breakdown of IFD Entry 13</strong></p><div class="table-wrapper"><table><thead><tr><th>Byte<th>Hex<th>Meaing<th>Information<tbody><tr><td>0 to 11<td><code class="language-plaintext highlighter-rouge">88 25 00 04 00 00 00 01 00 00 03 1E</code><td>IFD Entry 13<td>12-Bytes<tr><td>0 to 1<td><code class="language-plaintext highlighter-rouge">88 25</code><td>Field Identifying Tag<td>GPSTag<tr><td>2 to 3<td><code class="language-plaintext highlighter-rouge">00 04</code><td>Field Type<td>LONG (4 byte unsigned integer)<tr><td>4 to 7<td><code class="language-plaintext highlighter-rouge">00 00 00 01</code><td>Count of the Type<td>1 count<tr><td>8 to 11<td><code class="language-plaintext highlighter-rouge">00 00 03 1E</code><td>The Value Offset<td>Offset 798</table></div><p>Starting from the beginning of the TIFF File, the GPS IFD should start at offset 798 and what follows is a new IFD with its own number of 12-byte entries and values.</p><p><img data-src="//assets/img/Corrupted-Image/GPS-Info-IFD.png" alt="GPS-Info-IFD" data-proofer-ignore></p><p>Following the same IFD structure of 2-byte number of entries and then x number of 12-byte entries, we can determine what this IFD has in it.</p><p><strong>GPS Info IFD Breakdown</strong></p><div class="table-wrapper"><table><thead><tr><th>Bytes<th>Hex<th>Meaning<tbody><tr><td>0 to 1<td><code class="language-plaintext highlighter-rouge">00 09</code><td>9 Directory Entries<tr><td> <td><code class="language-plaintext highlighter-rouge">00 01 00 02 00 00 00 02 4E 00 00 00</code><td>Entry 0<tr><td> <td><code class="language-plaintext highlighter-rouge">00 02 00 05 00 00 00 03 00 00 03 90</code><td>Entry 1<tr><td> <td><code class="language-plaintext highlighter-rouge">00 03 00 02 00 00 00 02 57 00 00 00</code><td>Entry 2<tr><td> <td><code class="language-plaintext highlighter-rouge">00 04 00 05 00 00 00 03 00 00 03 A8</code><td>Entry 3<tr><td> <td><code class="language-plaintext highlighter-rouge">00 05 00 01 00 00 00 01 00 00 00 00</code><td>Entry 4<tr><td> <td><code class="language-plaintext highlighter-rouge">00 06 00 05 00 00 00 01 00 00 03 C0</code><td>Entry 5<tr><td> <td><code class="language-plaintext highlighter-rouge">00 07 00 05 00 00 00 03 00 00 03 C8</code><td>Entry 6<tr><td> <td><code class="language-plaintext highlighter-rouge">00 1B 00 07 00 00 00 0C 00 00 03 E0</code><td>Entry 7<tr><td> <td><code class="language-plaintext highlighter-rouge">00 1D 00 02 00 00 00 0B 00 00 03 EC</code><td>Entry 8<tr><td> <td><code class="language-plaintext highlighter-rouge">00 00 00 00 00</code><td>Offset to Next IFD (None)</table></div><p>There are 9 directory entries in this GPS Info IFD. A <a href="https://exiftool.org/TagNames/GPS.html">GPS Info Tag</a> reference can be used to identify the field tags.</p><div class="table-wrapper"><table><thead><tr><th>Entry #<th>Field Tag<th>Field Type<th>Count<th>Value<tbody><tr><td>0<td>GPSLatitudeRef<td>ASCII<td>2<td>N<tr><td>1<td>GPSLatitude<td>RATIONAL<td>3<td>Value at offset 0390 = 42 58 13.1555<tr><td>2<td>GPSLongitudeRef<td>ASCII<td>2<td>W<tr><td>3<td>GPSLongitude<td>RATIONAL<td>3<td>Value at offset 03A8 = 85 40 13.7531<tr><td>4<td>GPSAltitudeRef<td>BYTE<td>1<td>0 = Above Sea Level<tr><td>5<td>GPSAltitude<td>RATIONAL<td>1<td>Value at offset 03C0 = 180.552<tr><td>6<td>GPSTimeStamp<td>RATIONAL<td>3<td>Value at offset 03C8 = 23:28:24 UTC<tr><td>7<td>GPSProcessingMethod<td>UNDEFINED<td>12<td>Skip<tr><td>8<td>GPSDateStamp<td>ASCII<td>11<td>Value at offset 03EC = 2023:09:27</table></div><p>Each RATIONAL Field Type consists of 2 LONGs. The first LONG is the numerator and the second LONG is the denominator. I converted the hex values to their decimal value and divided.</p><p>As an example, Entry 1 contains 3 RATIONAL values.</p><p>The first value is a LONG at offset 0390 is <code class="language-plaintext highlighter-rouge">00 00 00 2A</code> (42) followed by the second LONG <code class="language-plaintext highlighter-rouge">00 00 00 01</code> (1) The second value is <code class="language-plaintext highlighter-rouge">00 00 00 3A</code> (58), followed by the second LONG <code class="language-plaintext highlighter-rouge">00 00 00 01</code> (1) The third value is a LONG <code class="language-plaintext highlighter-rouge">00 02 01 E3 </code>(131555) and the second LONG <code class="language-plaintext highlighter-rouge">00 00 27 10</code> (10000) After dividing 131555 by 10000 you have 13.1555.</p><p>The 3 RATIONAL values are in a Degrees, Minutes, Seconds format. <code class="language-plaintext highlighter-rouge">42° 58' 13.155"</code></p><p>The Final Coordinates are: <code class="language-plaintext highlighter-rouge">42° 58' 13.155" N</code> <code class="language-plaintext highlighter-rouge">85° 40' 13.7531" W</code></p><p><img data-src="//assets/img/Corrupted-Image/img-6.png" alt="Exif" data-proofer-ignore></p><p><strong>Ta-Da</strong></p><p><img data-src="//assets/img/Corrupted-Image/Christoph-Waltz-Ta-Da-GIF.gif" alt="Ta-Da" data-proofer-ignore></p><p>These coordinates are for this address:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>United States District Court for the Western District of Michigan
110 Michigan Street Northwest, Grand Rapids, MI 49503 
United States of America
</pre></table></code></div></div><p>The original, uncorrupted image: <img data-src="//assets/img/Corrupted-Image/Original_IMG.jpg" alt="Original" data-proofer-ignore></p><h1 id="references">References:</h1><p>https://www.garykessler.net/library/file_sigs.html https://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf https://exiv2.org/tags.html https://docs.fileformat.com/image/exif/ https://exiftool.org/TagNames/GPS.html</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/writeup/'>WriteUp</a>, <a href='//categories/digital-forensics/'>Digital Forensics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/writeup/" class="post-tag no-text-decoration" >WriteUp</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Manual+Recovery+of+Location+Data+From+JPG+-+L15t3Nr&url=https%3A%2F%2Fl15t3nr.github.io%2Fposts%2FCorrupted-Image%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Manual+Recovery+of+Location+Data+From+JPG+-+L15t3Nr&u=https%3A%2F%2Fl15t3nr.github.io%2Fposts%2FCorrupted-Image%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fl15t3nr.github.io%2Fposts%2FCorrupted-Image%2F&text=Manual+Recovery+of+Location+Data+From+JPG+-+L15t3Nr" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/FAT32-Access-Time/">Sunday Funday # 814 - FAT32 Access Time</a><li><a href="/posts/Corrupted-Image/">Manual Recovery of Location Data From JPG</a><li><a href="/posts/Wreath-Network-Write-up/">Wreath Network</a><li><a href="/posts/Olympus/">Olympus</a><li><a href="/posts/Napping/">Napping</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/napping/">Napping</a> <a class="post-tag" href="/tags/olympus/">Olympus</a> <a class="post-tag" href="/tags/wonderland/">Wonderland</a> <a class="post-tag" href="/tags/wreath/">Wreath</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FAT32-Access-Time/"><div class="card-body"> <em class="small" data-ts="1745168400" data-df="ll" > Apr 20, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sunday Funday # 814 - FAT32 Access Time</h3><div class="text-muted small"><p> Sunday Funday # 814 - David Cowen - HECFBlog Challenge: FAT32 does not store a time stamp for access dates, it only records the date. However many tools have or have in the past actually treated t...</p></div></div></a></div><div class="card"> <a href="/posts/Wreath-Network-Write-up/"><div class="card-body"> <em class="small" data-ts="1657386000" data-df="ll" > Jul 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Wreath Network</h3><div class="text-muted small"><p> The Wreath Network can be found here Executive Summary The penetration test was performed at the request of the client, Thomas Wreath. The client provided details of the network prior to the te...</p></div></div></a></div><div class="card"> <a href="/posts/Olympus/"><div class="card-body"> <em class="small" data-ts="1658163600" data-df="ll" > Jul 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Olympus</h3><div class="text-muted small"><p> Olympus can be found here Enumeration The first step is to scan the target with nmap to discover running services. nmap 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Lin...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/Wonderland/" class="btn btn-outline-primary" prompt="Older"><p>Wonderland</p></a> <a href="//posts/FAT32-Access-Time/" class="btn btn-outline-primary" prompt="Newer"><p>Sunday Funday # 814 - FAT32 Access Time</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://infosec.exchange/@L15t3Nr">L15t3Nr</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/napping/">Napping</a> <a class="post-tag" href="/tags/olympus/">Olympus</a> <a class="post-tag" href="/tags/wonderland/">Wonderland</a> <a class="post-tag" href="/tags/wreath/">Wreath</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
